import{E as nt,G as Y,r as v,H as rt,c as A,o as I,F as ot,l as it,a as st,I as C,m as at,J as S,K as lt,L as ut,g as z,M as E}from"./index-BuWtbWgA.js";function ct(t){return lt()?(ut(t),!0):!1}const J=typeof window<"u";function ft(t,e){function n(...r){t(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})}return n}function dt(t,e={}){let n,r;return a=>{const i=z(t),s=z(e.maxWait);if(n&&clearTimeout(n),i<=0||s!==void 0&&s<=0)return r&&(clearTimeout(r),r=null),a();s&&!r&&(r=setTimeout(()=>{n&&clearTimeout(n),r=null,a()},s)),n=setTimeout(()=>{r&&clearTimeout(r),r=null,a()},i)}}function mt(t,e=200,n={}){return ft(dt(e,n),t)}function ht(t){var e;const n=z(t);return(e=n?.$el)!=null?e:n}const gt=J?window:void 0,T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L="__vueuse_ssr_handlers__";T[L]=T[L]||{};var N=Object.getOwnPropertySymbols,yt=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable,vt=(t,e)=>{var n={};for(var r in t)yt.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&N)for(var r of N(t))e.indexOf(r)<0&&wt.call(t,r)&&(n[r]=t[r]);return n};function bt(t,e,n={}){const r=n,{window:o=gt}=r,a=vt(r,["window"]);let i;const s=o&&"ResizeObserver"in o,l=()=>{i&&(i.disconnect(),i=void 0)},c=Y(()=>ht(t),f=>{l(),s&&o&&f&&(i=new ResizeObserver(e),i.observe(f,a))},{immediate:!0,flush:"post"}),u=()=>{l(),c()};return ct(u),{isSupported:s,stop:u}}var P,j;J&&window?.navigator&&((P=window?.navigator)!=null&&P.platform)&&/iP(ad|hone|od)/.test((j=window?.navigator)==null?void 0:j.platform);const pt=({breakpoints:t,wrapperWidth:e,gutter:n,hasAroundGutter:r,initWidth:o})=>{const a=Object.keys(t).map(u=>Number(u)).sort((u,f)=>u-f);let i=e,s=!1;for(const u of a)if(e<=u){i=u,s=!0;break}if(!s)return o;let l=0;const c=t[i].rowPerView;return r?l=(e-n)/c-n:l=(e-(c-1)*n)/c,Math.floor(l)};function _t(t){const e=v(0),n=v(null);bt(n,i=>{const s=i[0],{width:l}=s.contentRect;e.value=l});const r=S(()=>pt({wrapperWidth:e.value,breakpoints:t.breakpoints,gutter:t.gutter,hasAroundGutter:t.hasAroundGutter,initWidth:t.width})),o=S(()=>{const i=t.hasAroundGutter?-t.gutter:t.gutter,s=(e.value+i)/(r.value+t.gutter);return Math.floor(s)}),a=S(()=>{if(t.align==="left")return 0;if(t.align==="center"){const i=t.hasAroundGutter?t.gutter:-t.gutter,s=o.value*(r.value+t.gutter)+i;return(e.value-s)/2}else{const i=t.hasAroundGutter?t.gutter:-t.gutter,s=o.value*(r.value+t.gutter)+i;return e.value-s}});return{waterfallWrapper:n,wrapperWidth:e,colWidth:r,cols:o,offsetX:a}}function Q(t,e){return new RegExp(`(^|\\s)${e}(\\s|$)`).test(t.className)}function B(t,e){if(Q(t,e))return;const n=t.className.split(/\s+/);n.push(e),t.className=n.join(" ")}const Ot=document.createElement("div").style,R=(()=>{const t={standard:"transform",webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform"};for(const e in t){const n=t[e];if(Ot[n]!==void 0)return e}return!1})();function b(t){return R===!1?!1:R==="standard"?t:R+t.charAt(0).toUpperCase()+t.substr(1)}const x=b("transform"),W=b("animation-duration"),k=b("animation-delay"),G=b("transition"),M=b("animation-fill-mode");function At(t,e,n,r,o,a,i){const s=v([]),l=v(0),c=h=>{const d=t.hasAroundGutter?h+1:h;return t.gutter*d+e.value*h+r.value},u=()=>{s.value=new Array(n.value).fill(t.hasAroundGutter?t.gutter:0)},f=St(t);return{wrapperHeight:l,layoutHandle:async()=>new Promise(h=>{u();const d=[];if(o&&o.value&&o.value.childNodes.forEach(m=>{m.className==="waterfall-item"&&d.push(m)}),d.length===0)return!1;for(let m=0;m<d.length;m++){const O=d[m];let y=It(s.value,i),$=s.value[y];a&&(y=m%n.value,$=s.value[y]);const Z=c(y),p=O.style;x&&(p[x]=`translate3d(${Math.floor(Z)}px,${Math.floor($)}px, 0)`),p.width=`${e.value}px`,p.visibility="visible";const{height:tt}=O.getBoundingClientRect();s.value[y]+=tt+t.gutter,t.animationCancel||f(O,()=>{const et=t.posDuration/1e3;G&&(p[G]=`transform ${et}s`)})}l.value=Math.max.apply(null,s.value),setTimeout(()=>{h(!0)},t.posDuration)})}}function It(t,e){if(t.length===0)return-1;const n=Math.min(...t),r=n+e;let o=-1;for(let a=0;a<t.length;a++)if(t[a]>=n&&t[a]<=r){o=a;break}return o}function St(t){return(e,n)=>{const r=e.firstChild;if(r&&!Q(r,t.animationPrefix)){const o=`${t.animationDuration/1e3}s`,a=`${t.animationDelay/1e3}s`,i=r.style;B(r,t.animationPrefix),B(r,t.animationEffect),W&&(i[W]=o),k&&(i[k]=a),M&&(i[M]="both"),n&&setTimeout(()=>{n()},t.animationDuration+t.animationDelay)}}}const Et=typeof window<"u"&&window!==null,V=Dt(),Rt=Object.prototype.propertyIsEnumerable,F=Object.getOwnPropertySymbols;function zt(t,...e){return e.map(r=>r.replace(/\[(\w+)\]/g,".$1").split(".").reduce((o,a)=>o&&o[a],t))}function Dt(){return Et&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function w(t){return typeof t=="function"||toString.call(t)==="[object Object]"}function $t(t){return typeof t=="object"?t===null:typeof t!="function"}function Ct(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}function Tt(t,...e){if(!w(t))throw new TypeError("expected the first argument to be an object");if(e.length===0||typeof Symbol!="function"||typeof F!="function")return t;for(const n of e){const r=F(n);for(const o of r)Rt.call(n,o)&&(t[o]=n[o])}return t}function q(t,...e){let n=0;for($t(t)&&(t=e[n++]),t||(t={});n<e.length;n++)if(w(e[n])){for(const r of Object.keys(e[n]))Ct(r)&&(w(t[r])&&w(e[n][r])?q(t[r],e[n][r]):t[r]=e[n][r]);Tt(t,e[n])}return t}function H(t,e){return new Promise((n,r)=>{const o=new Image;o.onload=()=>{n(o)},o.onerror=()=>{r(new Error("Image load error"))},e&&(o.crossOrigin="Anonymous"),o.src=t})}var g;(function(t){t.LOADING="loading",t.LOADED="loaded",t.ERROR="error"})(g||(g={}));const Lt={rootMargin:"0px",threshold:0},K="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Nt="";class Pt{constructor(e=!0,n,r=!0){this.lazyActive=!0,this.crossOrigin=!0,this.options={loading:K,error:Nt,observerOptions:Lt,log:!0,ratioCalculator:(o,a)=>a/o},this._images=new WeakMap,this.lazyActive=e,this.crossOrigin=r,this.config(n)}config(e={}){q(this.options,e),e.ratioCalculator&&(this.options.ratioCalculator=e.ratioCalculator)}mount(e,n,r){const{src:o,loading:a,error:i}=this._valueFormatter(n);e.setAttribute("lazy",g.LOADING),e.setAttribute("src",a||K),this.lazyActive?(V||(this._setImageSrc(e,o,r,i),this._log(()=>{throw new Error("Not support IntersectionObserver!")})),this._initIntersectionObserver(e,o,r,i)):this._setImageSrc(e,o,r,i)}resize(e,n){const r=e.getAttribute("lazy"),o=e.getAttribute("src");r&&r===g.LOADED&&o&&H(o,this.crossOrigin).then(a=>{const{width:i,height:s}=a,l=e.width/i*s;e.height=l;const c=e.style;c.height=`${l}px`,n()})}unmount(e){const n=this._realObserver(e);n&&n.unobserve(e),this._images.delete(e)}_setImageSrc(e,n,r,o){!n||e.getAttribute("src")===n||H(n,this.crossOrigin).then(i=>{var s,l;const{width:c,height:u}=i,f=((l=(s=this.options).ratioCalculator)==null?void 0:l.call(s,c,u))||u/c,_=e.parentNode.parentNode;_.style.paddingBottom=`${f*100}%`,e.setAttribute("lazy",g.LOADED),e.removeAttribute("src"),e.src=i.src,r(!0)}).catch(()=>{const i=this._realObserver(e);i&&i.disconnect(),o&&(e.setAttribute("lazy",g.ERROR),e.setAttribute("src",o),r(!1)),this._log(()=>{throw new Error(`Image failed to load!And failed src was: ${n} `)})})}_isOpenLazy(){return V&&this.lazyActive}_initIntersectionObserver(e,n,r,o){const a=this.options.observerOptions;this._images.set(e,new IntersectionObserver(s=>{Array.prototype.forEach.call(s,l=>{if(l.isIntersecting){const c=this._realObserver(e);c&&c.unobserve(l.target),this._setImageSrc(e,n,r,o)}})},a));const i=this._realObserver(e);i&&i.observe(e)}_valueFormatter(e){let n=e,r=this.options.loading,o=this.options.error;return w(e)&&(n=e.src,r=e.loading||this.options.loading,o=e.error||this.options.error),{src:n,loading:r,error:o}}_log(e){this.options.log&&e()}_realObserver(e){return this._images.get(e)}}var jt=(t,e)=>{for(const[n,r]of e)t[n]=r;return t};const D=nt({props:{list:{type:Array,default:()=>[]},rowKey:{type:String,default:"id"},imgSelector:{type:String,default:"src"},width:{type:Number,default:200},breakpoints:{type:Object,default:()=>({1200:{rowPerView:3},800:{rowPerView:2},500:{rowPerView:1}})},gutter:{type:Number,default:10},hasAroundGutter:{type:Boolean,default:!0},posDuration:{type:Number,default:300},animationPrefix:{type:String,default:"animate__animated"},animationEffect:{type:String,default:"fadeIn"},animationDuration:{type:Number,default:1e3},animationDelay:{type:Number,default:300},animationCancel:{type:Boolean,default:!1},backgroundColor:{type:String,default:"#fff"},lazyload:{type:Boolean,default:!0},loadProps:{type:Object,default:()=>{}},crossOrigin:{type:Boolean,default:!0},delay:{type:Number,default:300},align:{type:String,default:"center"},horizontalOrder:{type:Boolean,default:!1},heightDifference:{type:Number,default:0}},setup(t,e){const n=new Pt(t.lazyload,t.loadProps,t.crossOrigin);E("lazy",n);const{waterfallWrapper:r,wrapperWidth:o,colWidth:a,cols:i,offsetX:s}=_t(t),{wrapperHeight:l,layoutHandle:c}=At(t,a,i,s,r,t.horizontalOrder,t.heightDifference),u=mt(()=>{c().then(()=>{e.emit("afterRender")})},t.delay);Y(()=>[o,a,t.list],()=>{o.value>0&&u()},{deep:!0});const f=v(0);return E("sizeChangeTime",f),E("imgLoaded",u),{colWidth:a,waterfallWrapper:r,wrapperHeight:l,getRenderURL:d=>zt(d,t.imgSelector)[0],getKey:(d,m)=>d[t.rowKey]||m,renderer:u}}}),U=()=>{rt(t=>({feb77110:t.backgroundColor}))},X=D.setup;D.setup=X?(t,e)=>(U(),X(t,e)):U;const Bt=D,xt={class:"waterfall-card"};function Wt(t,e,n,r,o,a){return I(),A("div",{ref:"waterfallWrapper",class:"waterfall-list",style:at({height:`${t.wrapperHeight}px`})},[(I(!0),A(ot,null,it(t.list,(i,s)=>(I(),A("div",{key:t.getKey(i,s),class:"waterfall-item"},[st("div",xt,[C(t.$slots,"default",{item:i,index:s,url:t.getRenderURL(i)},void 0),C(t.$slots,"item",{item:i,index:s,url:t.getRenderURL(i)},void 0)])]))),128))],4)}var Gt=jt(Bt,[["render",Wt],["__scopeId","data-v-380efca1"]]);export{Gt as W};
