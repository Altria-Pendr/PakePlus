import{I as n}from"./input-BM_f-ZFN.js";import{B as f}from"./button-lfGp2GGb.js";import{F as g,_ as h}from"./captcha-KePjXd6l.js";import{T as c}from"./toast-D-c1V8F9.js";import{_ as k,u as I,r as i,c as v,e as t,f as r,i as y,o as S,a as u,y as p,t as b,k as w}from"./index-BuWtbWgA.js";const x={class:"root"},B={class:"tips"},C={__name:"login",setup(D){const m=I(),o=i(""),l=i(null),_=async s=>{if(s.verify){const[e,a]=await b("/api/v1/auth/Login",{Telephone:s.data.tel,Password:s.data.password,CaptchaID:o.value,Captcha:s.data.captcha});a?(console.error("登录失败",a),l.value.getCaptcha(),c("登录失败: "+(a.response.data.message||a.message||"未知错误"))):(c("登录成功"),localStorage.setItem("access_token",e.data.access_token),localStorage.setItem("refresh_token",e.data.refresh_token),m.setLoginStatus(!0),w.replace({name:"start"}))}};return(s,e)=>{const a=y("router-link");return S(),v("div",x,[t(g,{onSubmit:_},{default:r(()=>[e[4]||(e[4]=u("span",{class:"title"},"登录",-1)),t(n,{class:"input",name:"tel",label:"电话",type:"tel",required:!0,pattern:/^1[3-9]\d{9}$/,patternErrorMessage:"请输入正确的中国大陆手机号码"}),t(n,{class:"input",name:"password",label:"密码",type:"password",required:!0,pattern:/^(?=.*[A-Za-z])(?=.*\d).{8,}$/,patternErrorMessage:"密码需8位以上且必须包含英文和数字"}),t(n,{class:"input",name:"captcha",label:"验证码",type:"text",required:!0,pattern:/^[a-zA-Z0-9]{4}$/,patternErrorMessage:"请输入正确的验证码"},{append:r(()=>[t(h,{captchaID:o.value,"onUpdate:captchaID":e[0]||(e[0]=d=>o.value=d),ref_key:"captchaRef",ref:l},null,8,["captchaID"])]),_:1}),t(f,{class:"action",type:"submit"},{default:r(()=>e[1]||(e[1]=[p("登录")])),_:1,__:[1]}),u("span",B,[e[3]||(e[3]=p("没有账号？")),t(a,{to:{name:"register"}},{default:r(()=>e[2]||(e[2]=[p("点击注册")])),_:1,__:[2]})])]),_:1,__:[4]})])}}},M=k(C,[["__scopeId","data-v-0a1a9156"]]);export{M as default};
